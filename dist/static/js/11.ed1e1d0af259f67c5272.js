webpackJsonp([11],{WHQY:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=o("mvHQ"),a=o.n(l),r=(o("0RrJ"),{name:"StaffManage",data:function(){var e=this,t=/^[a-zA-Z][a-zA-Z0-9_]{6,10}$/,o=/^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{6,16}$/,l=/^1[3578]\d{9}$/,a=/^[\u4E00-\u9FA5A-Za-z0-9_]{1,6}$/;return{url:"http://localhost/th5/public/adminStaffManage/staff/",rules:{name:[{validator:function(e,t,o){""===t?o(new Error("请创建昵称")):(null==t.match(a)&&o(new Error("昵称规则：中文、英文、数字包括下划线")),o())},trigger:"blur"}],account:[{validator:function(e,o,l){if(!o)return l(new Error("账号不可为空"));setTimeout(function(){null==o.match(t)?l(new Error("账号规则：6-10位英文+数字，英文开头")):l()},1e3)},trigger:"blur"}],password:[{validator:function(e,t,l){""===t?l(new Error("请输入密码")):(null==t.match(o)&&l(new Error("密码规则：8-10位英文+数字,必须包含大小写字母和数字")),l())},trigger:"blur"}],phone:[{validator:function(e,t,o){t?(null==t.match(l)&&o(new Error("手机号规则：13,15,17,18开头，11位数字")),o()):o(new Error("请输入手机号"))},trigger:"blur"}],checkRole:[{validator:function(t,o,l){""===e.form.checkRole?l(new Error("请选择职位")):l()},trigger:"blur"}],sex:[{validator:function(e,t,o){""===t?o(new Error("请选择性别")):o()},trigger:"blur"}]},delBtnDisabled:!0,dialogTitle:"",selectInfo:"",selectVal:"",roleArr:[],staffArr:[],selectRow:[],addDialogForm:!1,editDialogForm:!1,form:{name:"",account:"",password:"",phone:"",head_img:"https://dss1.bdstatic.com/70cFvXSh_Q1YnxGkpoWK1HF6hhy/it/u=1091405991,859863778&fm=26&gp=0.jpg",checkRole:"",sex:"男",delivery:!1},formLabelWidth:"120px",options:[{value:"1",label:"账号"},{value:"2",label:"昵称"},{value:"3",label:"手机号"},{value:"4",label:"职位"}],allPages:{nowPage:1,allPage:0,total:0}}},mounted:function(){console.log(this.allPages);this.getStaff(1)},methods:{handleSelectionChange:function(e){var t=this,o=[];e.forEach(function(e,l){t.staffArr.forEach(function(t,l){e.id==t.id&&o.push(e.id)})}),this.selectRow=o,this.selectRow.length>0?this.delBtnDisabled=!1:this.delBtnDisabled=!0},getStaff:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.staffArr=[];var o=this.selectVal;this.$post(this.url+"getStaffArr",{keyWord:o,nowPage:t}).then(function(t){e.allPages.total=t.count,e.staffArr=t.data}).catch(function(e){console.log(e)})},addStaff:function(e){var t=this;this.$refs.MyForm.validate(function(o){if(!o)return!1;t.$post(t.url+"addStaff",{data:e}).then(function(e){var o="";1==e.code?(o="success",t.form={},t.addDialogForm=!1):o="error",t.$message({showClose:!0,message:e.msg,type:o}),t.getStaff(t.allPages.nowPage)}).catch(function(e){console.log(e)})})},enterEdit:function(e){var t=this;this.$refs.MyForm.validate(function(o){if(!o)return!1;t.$post(t.url+"editStaff",{data:e}).then(function(e){var o="";1==e.code?(o="success",t.editDialogForm=!1,t.form={}):o="error",t.$message({showClose:!0,message:e.msg,type:o}),t.getStaff(t.allPages.nowPage)}).catch(function(e){console.log(e)})})},getRoleArr:function(){var e=this;e.$post(e.url+"getRoleArr",{}).then(function(t){e.roleArr=t.data}).catch(function(e){console.log(e)})},editState:function(e,t){var o=this;1==t.state?t.state=0:t.state=1;var l=this;l.$post(l.url+"editState",{id:t.id,state:t.state}).then(function(e){var t="";t=1==e.code&&1==e.data?"success":"error",l.$message({showClose:!0,message:e.msg,type:t}),l.getStaff(o.allPages.nowPage)}).catch(function(e){console.log(e)})},editStaff:function(e){this.form=e,this.dialogTitle="修改员工信息",this.editDialogForm=!0},delStaff:function(e){var t=this;this.$post(this.url+"delStaff",{data:e}).then(function(e){var o=1==e.code?"success":"error";t.$message({showClose:!0,message:e.msg,type:o}),t.getStaff(1)}).catch(function(e){console.log(e)})},batchDeleteStaff:function(){var e=this,t=a()(this.selectRow);this.$fetch(this.url+"batchDeleteStaff",{delArr:t}).then(function(t){var o=1==t.code?"success":"error";e.$message({showClose:!0,message:t.msg,type:o}),e.getStaff(1),console.log(t)}).catch(function(e){console.log(e)})},resetPsw:function(e){var t=this;this.$fetch(this.url+"resetPsw",{data:e}).then(function(e){var o=1==e.code?"success":"error",l="";l=e.data?e.msg+",初始密码为："+e.data:e.msg,t.$message({showClose:!0,message:l,type:o})}).catch(function(e){console.log(e)})},closeFun:function(e){this.form={},this.$refs.MyForm.resetFields()},uploadSuccess:function(e,t){console.log(e),console.log(t),this.form.head_img=URL.createObjectURL(t.raw)},beforeUploadImg:function(e){var t="image/jpeg"===e.type,o=e.size/1024/1024<2;return t||this.$message.error("上传头像图片只能是 JPG 格式!"),o||this.$message.error("上传头像图片大小不能超过 2MB!"),t&&o}}}),n={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{attrs:{id:"contanir"}},[o("el-row",{staticClass:"row-bg",attrs:{type:"flex",push:"3"}},[o("el-col",{attrs:{span:3}},[o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.addDialogForm=!0,e.dialogTitle="添加员工信息"}}},[e._v("添加员工")])],1),e._v(" "),o("el-col",{attrs:{span:3}},[o("el-popconfirm",{attrs:{title:"是否批量操作？删除后不可恢复"},on:{onConfirm:e.batchDeleteStaff}},[o("el-button",{attrs:{slot:"reference",type:"danger",disabled:e.delBtnDisabled},slot:"reference"},[e._v("批量删除")])],1)],1),e._v(" "),o("el-col",{attrs:{span:12}},[o("el-select",{staticStyle:{width:"100px"},attrs:{placeholder:"请选择"},model:{value:e.selectVal,callback:function(t){e.selectVal=t},expression:"selectVal"}},e._l(e.options,function(e){return o("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1),e._v(" "),o("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入内容"},model:{value:e.selectInfo,callback:function(t){e.selectInfo=t},expression:"selectInfo"}}),e._v(" "),o("el-button",{attrs:{icon:"el-icon-search"}})],1)],1),e._v(" "),o("el-dialog",{attrs:{title:e.dialogTitle,center:"",visible:e.addDialogForm},on:{close:e.closeFun,"update:visible":function(t){e.addDialogForm=t}}},[o("el-form",{ref:"MyForm",staticClass:"demo-ruleForm",attrs:{model:e.form,"status-icon":"",rules:e.rules}},[o("el-form-item",{attrs:{label:"员工账号",prop:"account","label-width":e.formLabelWidth}},[o("el-input",{attrs:{required:"true",placeholder:"请输入账号"},model:{value:e.form.account,callback:function(t){e.$set(e.form,"account",t)},expression:"form.account"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"员工密码",prop:"password","label-width":e.formLabelWidth}},[o("el-input",{attrs:{placeholder:"请输入密码","show-password":""},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"昵称",prop:"name","label-width":e.formLabelWidth}},[o("el-input",{attrs:{placeholder:"请输入昵称"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"手机号",prop:"phone","label-width":e.formLabelWidth}},[o("el-input",{attrs:{type:"text",placeholder:"请输入手机号",maxlength:"11","show-word-limit":""},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"员工职位",prop:"checkRole","label-width":e.formLabelWidth}},[o("el-select",{attrs:{placeholder:"请选择员工职位"},on:{focus:e.getRoleArr},model:{value:e.form.role_name,callback:function(t){e.$set(e.form,"role_name",t)},expression:"form.role_name"}},[e._l(e.roleArr,function(e,t){return["超级管理员"==e.role_name?o("el-option",{key:t,attrs:{disabled:"",value:e.role_name}}):o("el-option",{key:t,attrs:{label:e.role_name,value:e.role_name}})]})],2)],1),e._v(" "),o("el-form-item",{attrs:{label:"性别",prop:"sex","label-width":e.formLabelWidth}},[o("el-radio",{attrs:{label:"男"},model:{value:e.form.sex,callback:function(t){e.$set(e.form,"sex",t)},expression:"form.sex"}},[e._v("男")]),e._v(" "),o("el-radio",{attrs:{label:"女"},model:{value:e.form.sex,callback:function(t){e.$set(e.form,"sex",t)},expression:"form.sex"}},[e._v("女")])],1)],1),e._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.addDialogForm=!1}}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary",plain:!0},on:{click:function(t){return e.addStaff(e.form)}}},[e._v("确 定")])],1)],1),e._v(" "),o("el-dialog",{attrs:{title:e.dialogTitle,center:"",visible:e.editDialogForm},on:{close:e.closeFun,"update:visible":function(t){e.editDialogForm=t}}},[o("el-form",{ref:"MyForm",staticClass:"demo-ruleForm",attrs:{model:e.form,"status-icon":"",rules:e.rules}},[o("el-upload",{staticClass:"avatar-uploader",staticStyle:{"text-align":"center"},attrs:{action:"https://jsonplaceholder.typicode.com/posts/","show-file-list":!1,"on-success":e.uploadSuccess,"before-upload":e.beforeUploadImg}},[e.form.head_img?o("img",{staticClass:"avatar",attrs:{src:e.form.head_img}}):o("i",{staticClass:"el-icon-plus avatar-uploader-icon"})]),e._v(" "),o("el-form-item",{attrs:{label:"员工账号",prop:"account","label-width":e.formLabelWidth}},[o("span",[e._v(e._s(e.form.account))])]),e._v(" "),o("el-form-item",{attrs:{label:"昵称",prop:"name","label-width":e.formLabelWidth}},[o("el-input",{attrs:{placeholder:"请输入昵称"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"手机号",prop:"phone","label-width":e.formLabelWidth}},[o("el-input",{attrs:{type:"text",placeholder:"请输入手机号",maxlength:"11","show-word-limit":""},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"员工职位",prop:"checkRole","label-width":e.formLabelWidth}},[o("el-select",{attrs:{placeholder:"请选择员工职位"},on:{focus:e.getRoleArr},model:{value:e.form.role_name,callback:function(t){e.$set(e.form,"role_name",t)},expression:"form.role_name"}},[e._l(e.roleArr,function(e,t){return["超级管理员"==e.role_name?o("el-option",{key:t,attrs:{disabled:"",value:e.role_name}}):o("el-option",{key:t,attrs:{label:e.role_name,value:e.role_name}})]})],2)],1),e._v(" "),o("el-form-item",{attrs:{label:"性别",prop:"sex","label-width":e.formLabelWidth}},[o("el-radio",{attrs:{label:"男"},model:{value:e.form.sex,callback:function(t){e.$set(e.form,"sex",t)},expression:"form.sex"}},[e._v("男")]),e._v(" "),o("el-radio",{attrs:{label:"女"},model:{value:e.form.sex,callback:function(t){e.$set(e.form,"sex",t)},expression:"form.sex"}},[e._v("女")])],1)],1),e._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.addDialogForm=!1}}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary",plain:!0},on:{click:function(t){return e.enterEdit(e.form)}}},[e._v("确 定")])],1)],1),e._v(" "),o("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{"highlight-current-row":"",border:"",data:e.staffArr,"tooltip-effect":"dark"},on:{"selection-change":e.handleSelectionChange}},[o("el-table-column",{attrs:{align:"center",type:"selection"}}),e._v(" "),o("el-table-column",{attrs:{align:"center",prop:"id",sortable:"",label:"ID"}}),e._v(" "),o("el-table-column",{attrs:{align:"center",label:"账号"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("span",[e._v(e._s(t.row.account))])]}}])}),e._v(" "),o("el-table-column",{attrs:{align:"center",label:"昵称"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("span",[e._v(e._s(t.row.name))])]}}])}),e._v(" "),o("el-table-column",{attrs:{align:"center",label:"头像"},scopedSlots:e._u([{key:"default",fn:function(e){return[o("el-image",{staticStyle:{width:"80px","border-radius":"50%"},attrs:{src:e.row.head_img}})]}}])}),e._v(" "),o("el-table-column",{attrs:{align:"center",label:"手机号",width:"120px"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("span",[e._v(e._s(t.row.phone))])]}}])}),e._v(" "),o("el-table-column",{attrs:{align:"center",label:"职位"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("span",[e._v(e._s(t.row.role_name))])]}}])}),e._v(" "),o("el-table-column",{attrs:{align:"center",label:"性别"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("span",[e._v(e._s(t.row.sex))])]}}])}),e._v(" "),o("el-table-column",{attrs:{align:"center",label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.state?o("span",[e._v("解锁")]):0==t.row.state?o("span",[e._v("锁定")]):e._e()]}}])}),e._v(" "),o("el-table-column",{attrs:{align:"center",label:"操作",width:"240px"},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.state?o("el-button",{attrs:{type:"warning",icon:"el-icon-lock",circle:""},on:{click:function(o){return e.editState(t.row.id,t.row)}}}):0==t.row.state?o("el-button",{attrs:{type:"primary",icon:"el-icon-unlock",circle:""},on:{click:function(o){return e.editState(t.row.id,t.row)}}}):e._e(),e._v(" "),o("el-button",{attrs:{type:"primary",icon:"el-icon-edit",circle:""},on:{click:function(o){return e.editStaff(t.row)}}}),e._v(" "),o("el-popconfirm",{attrs:{title:"确认删除该用户？",icon:"el-icon-info",iconColor:"red"},on:{onConfirm:function(o){return e.delStaff(t.row.id)}}},[o("el-button",{attrs:{slot:"reference",type:"danger",icon:"el-icon-delete",circle:""},slot:"reference"})],1),e._v(" "),o("el-popconfirm",{attrs:{title:"是否重置密码？"},on:{onConfirm:function(o){return e.resetPsw(t.row.id)}}},[o("el-button",{attrs:{slot:"reference",type:"danger",icon:"el-icon-refresh",circle:""},slot:"reference"})],1)]}}])})],1),e._v(" "),o("el-pagination",{staticStyle:{"text-align":"center"},attrs:{background:"",layout:"prev, pager, next","page-size":8,total:e.allPages.total},on:{"current-change":e.getStaff}})],1)},staticRenderFns:[]};var s=o("VU/8")(r,n,!1,function(e){o("h2Jg")},"data-v-dd0c955c",null);t.default=s.exports},h2Jg:function(e,t){}});
//# sourceMappingURL=11.ed1e1d0af259f67c5272.js.map