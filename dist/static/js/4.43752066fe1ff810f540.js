webpackJsonp([4],{"1FZ6":function(e,t){},"8Z36":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("BO1k"),l=a.n(r),n=a("9K/l"),o={name:"OldGoods",data:function(){return{brandS:[],input3:"",select:"vehicle_name",saleCar:[],tabData:[],cityData:[],saleDate:[],series:[],currentPage:1,pagesize:4,dialogFormVisible:!1,ruleForm:{name:"",region:"",date1:"",resource:"",desc:"",imageUrl:"",value:[],salePrice:"",way:""},rules:{name:[{required:!0,message:"请输入车辆名称",trigger:"blur"}],way:[{required:!0,message:"请输入行驶路程",trigger:"blur"}],salePrice:[{required:!0,message:"请输入价格",trigger:"blur"}],region:[{required:!0,message:"请选择所属地区",trigger:"change"}],date1:[{required:!0,message:"请选择活动时间",trigger:"change"}],resource:[{required:!0,message:"请选择车辆标签",trigger:"change"}],desc:[{required:!0,message:"请填写车辆介绍",trigger:"blur"}],imageUrl:[{required:!0,message:"请上传图片",trigger:"blur"}],value:[{required:!0,message:"请选择车系",trigger:"blur"}]},dialogImageUrl:"",dialogVisible:!1,lastImgUrl:""}},created:function(){this.getData(),this.getCityData(),this.getTabData(),this.getSeriesData(),this.getTimeData()},methods:{open2:function(e){this.$message({message:e,type:"success"})},open4:function(e){this.$message.error(e)},getData:function(){var e=this;Object(n.a)("/goods/index/getSale").then(function(t){1==t.data.code&&(e.saleCar=t.data.data)}).catch(function(e){console.log(e)})},getCityData:function(){var e=this;Object(n.a)("/goods/index/getCity").then(function(t){1==t.data.code&&(e.cityData=t.data.data)}).catch(function(e){console.log(e)})},getTabData:function(){var e=this;Object(n.a)("/goods/index/getTab").then(function(t){console.log(t),1==t.data.code&&(e.tabData=t.data.data,console.log(e.tabData))}).catch(function(e){console.log(e)})},getTimeData:function(){var e=this;Object(n.a)("/goods/index/getTime").then(function(t){1==t.data.code&&(e.saleDate=t.data.data)}).catch(function(e){console.log(e)})},getSeriesData:function(){var e=this;Object(n.a)("/goods/index/getSeries").then(function(t){var a=[],r=t.data.series,n=t.data.brand,o=!0,i=!1,s=void 0;try{for(var c,u=l()(n);!(o=(c=u.next()).done);o=!0){var d=c.value;d.children=[],a.push(d);var m=!0,g=!1,f=void 0;try{for(var p,h=l()(r);!(m=(p=h.next()).done);m=!0){var v=p.value;v.brand_id==d.value&&d.children.push(v)}}catch(e){g=!0,f=e}finally{try{!m&&h.return&&h.return()}finally{if(g)throw f}}}}catch(e){i=!0,s=e}finally{try{!o&&u.return&&u.return()}finally{if(i)throw s}}e.brandS=a}).catch(function(e){console.log(e)})},filterTag:function(e,t){return t.vehicle_state===e},handleSizeChange:function(e){this.pagesize=e},handleCurrentChange:function(e){this.currentPage=e},sortByDate:function(e,t){return e.start_time-t.start_time},getColor:function(e){return"拍卖中"===e?"primary":"未审核"===e?"danger":"success"},filterChange:function(e){var t=this;if(e.vehicle_state.length>0){var a={state:e.vehicle_state[0]};Object(n.b)("/goods/index/stateFind",a).then(function(e){1==e.data.code?t.saleCar=e.data.data:t.open4(e.data.msg)}).catch(function(e){console.log(e)})}else this.getData()},handlePass:function(e,t){var a=this,r={id:t.vehicle_id};this.$confirm("此操作将上传该拍卖商品, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(n.b)("/goods/index/pass",r).then(function(e){1==e.data.code?(a.saleCar=e.data.data,a.open2(e.data.msg)):a.open4(e.data.msg)}).catch(function(e){console.log(e)})}).catch(function(){a.$message({type:"info",message:"已取消审核"})})},handleGetOut:function(e,t){var a=this,r={id:t.vehicle_id};this.$confirm("此操作将下架商品, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(n.b)("/goods/index/saleOut",r).then(function(e){1==e.data.code?(a.saleCar=e.data.data,a.open2(e.data.msg)):a.open4(e.data.msg)}).catch(function(e){console.log(e)})}).catch(function(){a.$message({type:"info",message:"已取消"})})},handleDelete:function(e,t){var a=this,r=t.vehicle_id,l={id:r};this.$confirm("此操作将下架商品, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(n.b)("/goods/index/delSale",l).then(function(e){if(1==e.data.code){for(var t in a.saleCar)a.saleCar[t].vehicle_id===r&&a.saleCar.splice(t,1);a.open2(e.data.msg)}else a.open4(e.data.msg)}).catch(function(e){console.log(e)})}).catch(function(){a.$message({type:"info",message:"已取消删除"})})},handleSearch:function(){var e=this,t={keyword:this.input3,condition:this.select};Object(n.b)("/goods/index/searchSale",t).then(function(t){1==t.data.code?e.saleCar=t.data.data:e.open4(t.data.msg)}).catch(function(e){console.log(e)})},submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;console.log(t.ruleForm);var a={imgUrl:t.lastImgUrl,ruleForm:t.ruleForm};Object(n.b)("/goods/index/issue",a).then(function(e){1==e.data.code?(t.open2(e.data.msg),t.dialogFormVisible=!1,t.getData()):t.open4(e.data.msg)}).catch(function(e){console.log(e)})})},handleRemove:function(e,t){console.log(e,t)},handlePictureCardPreview:function(e){this.dialogImageUrl=e.url,this.dialogVisible=!0},uploadSuccess:function(e,t,a){this.lastImgUrl=e},handleimgChange:function(e,t){this.ruleForm.imageUrl=URL.createObjectURL(e.raw)}}},i={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-row",[a("el-col",{attrs:{span:21}},[a("div",{staticStyle:{margin:"15px 0"}},[a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入内容"},model:{value:e.input3,callback:function(t){e.input3=t},expression:"input3"}},[a("el-select",{staticClass:"seBox",attrs:{slot:"prepend",placeholder:"请选择"},slot:"prepend",model:{value:e.select,callback:function(t){e.select=t},expression:"select"}},[a("el-option",{attrs:{label:"车辆名称",value:"vehicle_name"}}),e._v(" "),a("el-option",{attrs:{label:"拍卖者名",value:"name"}})],1),e._v(" "),a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.handleSearch},slot:"append"})],1)],1)]),e._v(" "),a("el-col",{attrs:{span:3}},[a("div",{staticStyle:{margin:"15px 0",float:"right"}},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogFormVisible=!0}}},[e._v("\n          发布\n          "),a("i",{staticClass:"el-icon-upload el-icon--right"})])],1)])],1),e._v(" "),a("el-dialog",{attrs:{title:"发布拍卖",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"车辆名称",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入车辆名称"},model:{value:e.ruleForm.name,callback:function(t){e.$set(e.ruleForm,"name",t)},expression:"ruleForm.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"行驶路程",prop:"way"}},[a("el-input",{attrs:{placeholder:"请输入行驶路程(km)"},model:{value:e.ruleForm.way,callback:function(t){e.$set(e.ruleForm,"way",t)},expression:"ruleForm.way"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"拍卖价格",prop:"salePrice"}},[a("el-input",{attrs:{placeholder:"请输入拍卖价格（万）"},model:{value:e.ruleForm.salePrice,callback:function(t){e.$set(e.ruleForm,"salePrice",t)},expression:"ruleForm.salePrice"}})],1),e._v(" "),a("el-form-item",{staticClass:"cityBox",attrs:{label:"所属地区",prop:"region"}},[a("el-select",{attrs:{placeholder:"请选择所属地区"},model:{value:e.ruleForm.region,callback:function(t){e.$set(e.ruleForm,"region",t)},expression:"ruleForm.region"}},e._l(e.cityData,function(e){return a("el-option",{key:e.city_id,attrs:{label:e.city_name,value:e.city_id}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"活动时间",prop:"date1"}},[a("el-select",{attrs:{placeholder:"请选择活动时间"},model:{value:e.ruleForm.date1,callback:function(t){e.$set(e.ruleForm,"date1",t)},expression:"ruleForm.date1"}},e._l(e.saleDate,function(e){return a("el-option",{key:e.id,attrs:{label:e.start_time+"~"+e.end_time,value:e.id}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"车牌系列",prop:"value"}},[a("el-cascader",{attrs:{options:e.brandS,props:{expandTrigger:"hover"}},model:{value:e.ruleForm.value,callback:function(t){e.$set(e.ruleForm,"value",t)},expression:"ruleForm.value"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"车辆标签",prop:"resource"}},[a("el-radio-group",{model:{value:e.ruleForm.resource,callback:function(t){e.$set(e.ruleForm,"resource",t)},expression:"ruleForm.resource"}},e._l(e.tabData,function(t,r){return a("el-radio",{key:r,attrs:{label:t.tab_id}},[e._v(e._s(t.tab_name))])}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"车辆介绍",prop:"desc"}},[a("el-input",{attrs:{type:"textarea",maxlength:"30","show-word-limit":""},model:{value:e.ruleForm.desc,callback:function(t){e.$set(e.ruleForm,"desc",t)},expression:"ruleForm.desc"}})],1),e._v(" "),a("el-form-item",{staticClass:"img_box",attrs:{label:"车辆图片",prop:"imageUrl"}},[e._e(),e._v(" "),a("el-upload",{attrs:{action:"http://127.0.0.1/peanut/th5/public/goods/index/upload","list-type":"picture-card",limit:1,"on-preview":e.handlePictureCardPreview,"on-remove":e.handleRemove,name:"image","on-success":e.uploadSuccess,"on-change":e.handleimgChange}},[a("i",{staticClass:"el-icon-plus"})])],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("立即创建")]),e._v(" "),a("el-button",{on:{click:function(t){return e.resetForm("ruleForm")}}},[e._v("重置")])],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")])],1)],1),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{border:"",data:e.saleCar.slice((e.currentPage-1)*e.pagesize,e.currentPage*e.pagesize)},on:{"filter-change":e.filterChange}},[a("el-table-column",{attrs:{label:"ID",width:"50"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.vehicle_id))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"开始时间",width:"120",sortable:"","sort-method":e.sortByDate},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.start_time))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"结束时间",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.end_time))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"车辆名称",width:"250"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{trigger:"hover",placement:"top"}},[a("p",[e._v("介绍: "+e._s(t.row.introduce))]),e._v(" "),a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[a("el-tag",{attrs:{size:"medium"}},[e._v(e._s(t.row.vehicle_name))])],1)])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"价格"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.price)+" 万")])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"图片"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("img",{staticStyle:{width:"60px",height:"50px"},attrs:{src:e.row.img}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"拍卖者"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{trigger:"hover",placement:"top"}},[a("p",[e._v("手机号: "+e._s(t.row.phone))]),e._v(" "),a("p",[e._v("账号: "+e._s(t.row.acc))]),e._v(" "),a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[a("el-tag",{attrs:{size:"medium"}},[e._v(e._s(t.row.name))])],1)])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"状态",filters:[{text:"已拍卖",value:"已拍卖"},{text:"未审核",value:"未审核"},{text:"拍卖中",value:"拍卖中"}],prop:"vehicle_state",align:"center","column-key":"vehicle_state","filter-method":e.filterTag,"filter-placement":"bottom-end","filter-multiple":!1},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:e.getColor(t.row.vehicle_state),"disable-transitions":""}},[e._v(e._s(t.row.vehicle_state))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"230"},scopedSlots:e._u([{key:"default",fn:function(t){return["未审核"===t.row.vehicle_state?a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.handlePass(t.$index,t.row)}}},[e._v("审核")]):a("el-button",{attrs:{size:"mini",disabled:"已拍卖"===t.row.vehicle_state},on:{click:function(a){return e.handleGetOut(t.$index,t.row)}}},[e._v("下架")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.handleDelete(t.$index,t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),a("div",{staticClass:"block"},[a("el-pagination",{attrs:{"current-page":e.currentPage,"page-size":e.pagesize,"page-sizes":[4,8,16,32],layout:"total, sizes, prev, pager, next, jumper",total:e.saleCar.length},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)},staticRenderFns:[]};var s=a("VU/8")(o,i,!1,function(e){a("1FZ6")},null,null);t.default=s.exports},BO1k:function(e,t,a){e.exports={default:a("fxRn"),__esModule:!0}},fxRn:function(e,t,a){a("+tPU"),a("zQR9"),e.exports=a("g8Ux")},g8Ux:function(e,t,a){var r=a("77Pl"),l=a("3fs2");e.exports=a("FeBl").getIterator=function(e){var t=l(e);if("function"!=typeof t)throw TypeError(e+" is not iterable!");return r(t.call(e))}}});
//# sourceMappingURL=4.43752066fe1ff810f540.js.map